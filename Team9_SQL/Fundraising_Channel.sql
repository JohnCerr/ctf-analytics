--a) Total Gift Amount, b) Total Number of Gifts, c) Average Gift Amount, d) Median Gift Amount, e) Average Number of Gifts MoM YTD + Last 4 CY
--Same as Above by Opportunity Record Type Last 4 CY

select
CASE
WHEN RECORDTYPEID = '012G00000018Ph8IAE' THEN 'General'
WHEN RECORDTYPEID = '012G00000018PhAIAU' THEN 'Major Gift'
WHEN RECORDTYPEID = '012G0000001BL5mIAG' THEN 'Classy'
WHEN RECORDTYPEID = '0124A000001QhLmQAK' THEN 'MobileCause'
WHEN RECORDTYPEID = '0124A000000WipdQAC' THEN 'OneCause'
ELSE NULL
END AS RECORD_TYPE,
COUNT(*),
SUM(AMOUNT) TOTAL_AMOUNT,
YEAR(CLOSEDATE) YEAR,
MONTH(CLOSEDATE) MONTH
from "PROD_CTF_CLEAN"."CTF_CLEAN_T9"."OPPORTUNITY"
Where ISCLOSED = 'TRUE' AND ISWON = 'TRUE' AND STAGENAME = 'Received'
GROUP BY RECORD_TYPE, YEAR, MONTH